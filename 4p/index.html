<!doctype html>

<html>
<head>
  <meta charset="utf-8"></meta>
  <title>Network Stuff</title>
  <script
  src="https://code.jquery.com/jquery-3.2.1.min.js"
  integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
  crossorigin="anonymous"></script>
  <!--<script src="/sockets"></script>-->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/1.7.3/socket.io.js"></script>
  <script src="/cytoscape"></script>
  <!--<script src="/socketstuff"></script>-->
  
  
  <!--<link rel="stylesheet" type="text/css" src="styles.css">-->
<style>
  #cy {
    width: 100%;
    height: 100%;
    position: absolute;
    top: 0px;
    left: 0px;
  }
</style>
</head>

<body>
  
    <div id="cy"></div>
    <!--connectivity of the graph
        i.e. all nodes have edges, and all nodes are connected in some capacity-->
    <h1 id="connected">
      connected?
    </h1>
    
    <!--generated paths from node -> destination-->
    <pre id="paths">
      paths?
    </pre>
  
  <script>
    let cy = cytoscape({container: document.getElementById('cy')})
    
    let layout
    let graph
    cy.json(graph)
  </script>
  <!--<script src="/graphstuff"></script>-->
<script> 
let socket = io('http://localhost:3000')
// let graphstuff = require('./graphstuff.js')

socket.on('connect', function(data){
  console.log(socket.id); // 'G5p5...'
});

socket.on('initGraph', function(data){
  console.log(data)
  graph = data.elements
  cy.json({elements: data.elements})
  console.log(JSON.stringify(data.elements.nodes, null, 2))
  
  // cy = cytoscape({})
  // cy.json(data)

  // cy.json(data)

  // layout = cy.layout({
  //   name: 'breadthfirst'
  // })

  // //renders the layout once everything is set
  // layout.run()
  console.log(JSON.stringify(cy.nodes().position(), null, 2))
})

  // $(document).on('click', function(event){
  //     socket.emit('clickaroo', event)
  //   })

    // socket.io.on('clickaroo', function(data){
    //   $(data.id).trigger('click')
    // })
// let socket = io.connect('http://localhost:3000')
// let cy = 
console.log(cy.nodes())
cy.nodes().on('click', function(data){
  // n = n.add(this)
  console.log('this data')
  console.log(this.data())
  socket.emit('clickaroo', { data: this.data()})
})

socket.on('clickaroo', function(data){
  console.log('received clickaroo')
  console.log(data.stuff)
  // $(data).trigger('click')
})

socket.on('clickaroo', function(data){
  console.log('received clickarood')
  console.log(data)
  // $(data).trigger('click')
})

</script>

</body>
</html>